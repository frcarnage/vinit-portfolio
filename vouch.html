<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vouches | Vinit</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
      color: #fff;
      overflow-x: hidden;
    }

    .container {
      max-width: 800px;
      margin: auto;
      padding: 40px 20px;
      text-align: center;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      color: #00f5ff;
    }

    .swiper {
      padding: 20px 0;
    }

    .vouch-card {
      background: #121212;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    }

    .vouch-card h3 {
      margin: 0 0 10px;
      font-size: 1.2rem;
      color: #00f5ff;
    }

    .vouch-card p {
      margin: 5px 0;
    }

    .vouch-card .date {
      font-size: 0.9rem;
      color: #aaa;
    }

    .like-btn {
      background: #00f5ff;
      color: #000;
      border: none;
      padding: 6px 12px;
      border-radius: 20px;
      cursor: pointer;
      margin-top: 10px;
    }

    .form-container {
      margin-top: 50px;
      background: #121212;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(0,255,255,0.3);
    }

    .form-container input,
    .form-container textarea {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: none;
      border-radius: 6px;
      background: #1f1f1f;
      color: #fff;
    }

    .form-container button {
      background: #00f5ff;
      border: none;
      color: #000;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üí¨ Vouches</h1>

    <!-- Vouch Display Slider -->
    <div class="swiper">
      <div class="swiper-wrapper" id="vouchSlider">
        <!-- Vouches will load here -->
      </div>
    </div>

    <!-- Leave a Vouch -->
    <div class="form-container">
      <h2>Leave a Vouch</h2>
      <input type="text" id="username" placeholder="Your name" />
      <textarea id="message" rows="4" placeholder="Your message..."></textarea>
      <button onclick="submitVouch()">Submit Vouch</button>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

  <!-- SwiperJS -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <script>
    // ‚úÖ Your real Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyD2K9DlaNBL5AM05wZLdOTvoFnZqGOdUnA",
      authDomain: "vinit-vouches.firebaseapp.com",
      projectId: "vinit-vouches",
      storageBucket: "vinit-vouches.appspot.com",
      messagingSenderId: "yourSenderID",
      appId: "yourAppID",
      databaseURL: "https://vinit-vouches-default-rtdb.firebaseio.com"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function formatDateTime(timestamp) {
      const date = new Date(timestamp);
      return date.toLocaleString();
    }

    function submitVouch() {
      const username = document.getElementById("username").value.trim();
      const message = document.getElementById("message").value.trim();
      if (!username || !message) return alert("Please fill all fields");

      const vouch = {
        username,
        message,
        timestamp: Date.now(),
        likes: 0
      };

      db.ref("vouches").push(vouch).then(() => {
        alert("‚úÖ Vouch submitted!");
        document.getElementById("username").value = "";
        document.getElementById("message").value = "";
        loadVouches(); // reload
      });
    }

    function loadVouches() {
      db.ref("vouches").once("value", (snapshot) => {
        const data = snapshot.val();
        const container = document.getElementById("vouchSlider");
        container.innerHTML = "";

        if (data) {
          const vouchArray = Object.entries(data).reverse();
          vouchArray.forEach(([id, v]) => {
            const liked = localStorage.getItem(`liked_${id}`) === "true";
            const vouchHTML = `
              <div class="swiper-slide">
                <div class="vouch-card">
                  <h3>üë§ ${v.username}</h3>
                  <p>üí¨ ${v.message}</p>
                  <p class="date">üìÖ ${formatDateTime(v.timestamp)}</p>
                  <button class="like-btn" onclick="likeVouch('${id}', ${v.likes})" ${liked ? "disabled" : ""}>
                    ‚ù§Ô∏è ${v.likes} Like${v.likes === 1 ? "" : "s"}
                  </button>
                </div>
              </div>`;
            container.innerHTML += vouchHTML;
          });

          new Swiper('.swiper', {
            slidesPerView: 1,
            spaceBetween: 20,
            loop: true,
            autoplay: {
              delay: 4000,
              disableOnInteraction: false,
            },
            pagination: {
              el: '.swiper-pagination',
              clickable: true,
            }
          });
        } else {
          container.innerHTML = `<p>No vouches yet.</p>`;
        }
      });
    }

    function likeVouch(id, currentLikes) {
      if (localStorage.getItem(`liked_${id}`)) return;
      db.ref("vouches/" + id + "/likes").set(currentLikes + 1);
      localStorage.setItem(`liked_${id}`, "true");
      loadVouches(); // reload to show updated likes
    }

    loadVouches();
  </script>
</body>
</html>
